webpackJsonp([26],{FRCh:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tpl-sl-details-body"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.showvideo,expression:"!showvideo"}]},[a("el-table",{staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:e.tableData,border:"",stripe:""},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"resName",label:"该知识点微课",align:"left","header-align":"center"}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showvideo,expression:"showvideo"}],staticClass:"tpl-sl-details-body"},[a("div",{staticClass:"tpl-sl-details-body-left"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.resId,expression:"!resId"}],staticClass:"center",staticStyle:{"line-height":"480px"}},[e._v(" \n                请选择资源\n            ")]),e._v(" "),a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:e.resId,expression:"resId"}],attrs:{type:"border-card"},model:{value:e.activeFlies,callback:function(t){e.activeFlies=t},expression:"activeFlies"}},e._l(e.files,function(t){return a("el-tab-pane",{key:t.fileId,attrs:{name:t.fileId,label:t.fileName}},[a("div",{staticClass:"tpl-sl-video-box"},[a("video",{ref:t.fileId,refInFor:!0,attrs:{src:e.makeUrl(t.path),autoplay:"",controls:"",height:"100%",width:"100%",loop:""}})])])})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.resId,expression:"resId"}],staticStyle:{padding:"10px"}},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"我要提问",name:"1"}},[a("el-input",{attrs:{type:"textarea",autofocus:"",rows:5,resize:"none",maxlength:1e3,autosize:{minRows:4,maxRows:8},placeholder:"请输入1000字以内的问题"},model:{value:e.question,callback:function(t){e.question="string"==typeof t?t.trim():t},expression:"question"}}),e._v(" "),a("div",{staticClass:"right",staticStyle:{padding:"10px 0"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("提交")])],1)],1)],1),e._v(" "),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"学生答疑",name:"1"}},[e._l(e.questionList,function(t){return a("div",{key:t.id,staticClass:"tpl-sl-notice-item"},[a("el-form",{ref:"ruleForm",refInFor:!0,staticClass:"demo-ruleForm",attrs:{model:e.backForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"学生提问："}},[a("pre",{staticStyle:{margin:"0"}},[e._v(e._s(t.content))])]),e._v(" "),t.slQuestionsDetailsVMList&&t.slQuestionsDetailsVMList.length>0?a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"教师回复："}},e._l(t.slQuestionsDetailsVMList,function(t){return a("pre",{key:t.id,staticStyle:{margin:"0"}},[e._v(e._s(t.content))])})):e._e(),e._v(" "),2!=e.$store.state.userType&&t.slQuestionsDetailsVMList&&0==t.slQuestionsDetailsVMList.length?a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"教师回复："}},[e._v("暂无回复")]):e._e(),e._v(" "),2==e.$store.state.userType&&t.slQuestionsDetailsVMList&&0==t.slQuestionsDetailsVMList.length?a("el-form-item",{attrs:{label:"教师回复："}},[a("el-input",{attrs:{type:"textarea",autofocus:"",rows:4,resize:"none",maxlength:1e3,autosize:{minRows:4,maxRows:8},placeholder:"请输入1000字以内的内容"},model:{value:e.backForm.anwser,callback:function(t){e.backForm.anwser="string"==typeof t?t.trim():t},expression:"backForm.anwser"}})],1):e._e()],1),e._v(" "),2==e.$store.state.userType&&t.slQuestionsDetailsVMList&&0==t.slQuestionsDetailsVMList.length?a("div",{staticClass:"right",staticStyle:{"padding-bottom":"10px"}},[a("el-button",{attrs:{type:"primary",loading:e.addMoreLoading}},[e._v("回复")])],1):e._e()],1)}),e._v(" "),e.isempty?e._e():a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.handleMore}},[e._v("加载更多")])],2)],1)],1)],1),e._v(" "),a("div",{staticClass:"tpl-sl-details-body-right"},e._l(e.tableData,function(t){return a("div",{key:t.id,staticClass:"tpl-sl-zsdwk-row cp",on:{click:function(a){e.handleChangeWK(t)}}},[a("i",{staticClass:"fa fa-film",attrs:{"aria-hidden":"true"}}),e._v(" "),a("span",{style:{color:t.selected?" #13CE66":"#666"}},[e._v(e._s(t.resName))]),e._v(" "),0==t.flag?a("i",{staticClass:"fa fa-check-circle",staticStyle:{color:"#13CE66"},attrs:{"aria-hidden":"true"}}):e._e()])}))])])},staticRenderFns:[]}},NE2S:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("bOdI"),i=a.n(s),n=a("fv5m");t.default={data:function(){var e;return e={activeName:"1",showvideo:!1,question:"",tableData:[],backForm:{anwser:""},filesurl:n.a},i()(e,"activeName","1"),i()(e,"activeFlies",""),i()(e,"question",""),i()(e,"defaultKey",""),i()(e,"addMoreLoading",!1),i()(e,"catalogTreeData",[]),i()(e,"isempty",!1),i()(e,"data",{}),i()(e,"name",""),i()(e,"start",1),i()(e,"resId",""),i()(e,"files",[]),i()(e,"questionList",[]),i()(e,"backForm",{anwser:""}),i()(e,"defaultProps",{children:"resourceInfoVM",label:"name"}),i()(e,"rules",{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}]}),i()(e,"currentData",{}),e},created:function(){this.init()},methods:{init:function(){var e=JSON.parse(window.sessionStorage.getItem("_course_data"));this.data=e||{},this.name=e.courseName,this.getKw()},getKw:function(){var e=this;a.i(n.b)({courseValue:this.data.courseValue,gradeValue:this.data.gradeValue}).then(function(t){t&&t.forEach(function(e,t){e.selected=!1}),e.tableData=t||[]})},handleRowClick:function(e,t,s){var i=this;e.selected=!0,this.currentData=e,this.showvideo=!this.showvideo,this.questionList=[],this.resId="",this.start=1,e.objId&&(this.resId=e.resId||"",a.i(n.c)(e.objId).then(function(e){i.files=e.files||[],i.activeFlies=i.files.length>0?i.files[0].fileId:"",i.getvideo()}),this.getQuestion())},getvideo:function(e){var t=this;a.i(n.d)().then(function(e){var s="",i="";e.allYearAndTermVMs&&e.allYearAndTermVMs.forEach(function(e,t){1==e.current&&(s=e.year)}),e.unitSchoolTermRHVM&&(i=e.unitSchoolTermRHVM.schoolTerm);var r={yearId:s,termId:i,courseValue:t.data.courseValue,resId:t.currentData.resId,resName:t.currentData.resName};1!=t.currentData.flag&&t.$nextTick(function(){var e=t.$refs[t.activeFlies][0];e.onplay=function(){var l=e.duration,o=parseInt(1e3*l/10),c=parseInt(e.currentTime);!function(l,o,c){var d=setInterval(function(){var o=parseInt(e.currentTime),u=e.ended;if(o!=c){r.second=parseInt(o-c),r.catelogName=t.currentData.parentName,r.catelogId=t.currentData.parentId,a.i(n.e)(r).then(function(e){});var h={yearId:s,termId:i,fileId:t.activeFlies,second:parseInt(o-c),percentage:parseInt(o/l*100),resId:t.currentData.resId,resName:t.currentData.resName};a.i(n.f)(h).then(function(e){})}u&&(r.typeId=1,r.catalogId=t.currentData.parentId,a.i(n.g)(r).then(function(e){})),(u||o>=l||o==c)&&clearInterval(d),c=o},o)}(l,o,c)}})}).catch(function(e){})},handleChangeWK:function(e){var t=this;e.selected=!0,this.currentData=e,this.questionList=[],this.resId="",this.start=1,e.objId&&(this.resId=e.resId||"",a.i(n.c)(e.objId).then(function(e){t.files=e.files||[],t.activeFlies=t.files.length>0?t.files[0].fileId:"",t.getvideo()}),this.getQuestion())},makeUrl:function(e){var t=e.split(".");t.length>0&&(t[t.length-1]="mp4");var a=t.join(".");return this.filesurl+a},handleSave:function(){var e=this,t={content:this.question,courseValue:this.data.courseValue,courseName:this.data.courseName,resId:this.resId};t.content&&a.i(n.h)(t).then(function(t){e.$notify({title:"成功",message:"提交成功！",type:"success"}),e.question="",e.start=1,e.getQuestion()})},handleMore:function(){this.start++,this.getQuestion()},getQuestion:function(){var e=this;this.resId&&(this.addMoreLoading=!0,a.i(n.i)({resId:this.resId,start:this.start,size:10}).then(function(t){t.list&&t.list.forEach(function(t,a){var s=!0;e.questionList.forEach(function(e,a){e.id==t.id&&(s=!1)}),s&&e.questionList.push(t)}),e.isempty=0==t.list.length,e.addMoreLoading=!1}).catch(function(t){e.addMoreLoading=!1}))},handleNodeClick:function(e){var t=this;this.currentData=e,this.questionList=[],this.resId="",this.start=1,e.objId&&(this.resId=e.resId||"",a.i(n.c)(e.objId).then(function(e){t.files=e.files||[],t.activeFlies=t.files.length>0?t.files[0].fileId:""}),this.getQuestion())},renderContent:function(e,t){var a=t.node,s=t.data;return t.store,e("span",{style:"padding: 5px 0;"},[e("span",null,[e("i",{style:{display:1!=a.level?"none":"",fontSize:"16px",position:"relative",top:"2px"},class:{fa:!0,"fa-folder-o":!a.expanded,"fa-folder-open-o":a.expanded},attrs:{"aria-hidden":"true"}},[]),e("span",{style:{display:"rc"!=s.type?"none":"inline-block",width:"36px",height:"36px",verticalAlign:"middle"}},[e("img",{style:"width: 100%;height: 100%;border-radius: 3px;",attrs:{src:photourl+s.userId}},[])]),e("span",null,[" ",s.name])])])},getCatalogTree:function(){var e=this;getResorceInformation({courseValue:this.data.courseValue,gradeValue:this.data.gradeValue}).then(function(t){t&&t.forEach(function(e,t){e.resourceInfoVM&&e.resourceInfoVM.forEach(function(t,a){t.name=t.resName,t.type="rc",t.id=t.resId,t.parentId=e.id,t.parentName=e.name})}),e.defaultKey=e.data.resId,e.catalogTreeData=e.data2tree(t)}).catch(function(e){})},data2tree:function(e,t,a){t||(t="id"),a||(a="parentId");for(var s=[],n=0;n<e.length;n++){var r=_.cloneDeep(e[n]);(r[a+""]||""==r[a+""])&&_.result(_.find(e,i()({},t,r[a+""])),t)||(function s(i){for(var n=[],r=0;r<e.length;r++){var l=_.cloneDeep(e[r]);l[a+""]==i[t+""]&&(n.push(l),s(l))}n.length&&(i.resourceInfoVM=n)}(r),s.push(r))}return s}}}},WsJK:function(e,t,a){var s=a("VU/8")(a("NE2S"),a("FRCh"),function(e){a("zXOQ")},"data-v-1cc6d8d6",null);e.exports=s.exports},zXOQ:function(e,t){}});