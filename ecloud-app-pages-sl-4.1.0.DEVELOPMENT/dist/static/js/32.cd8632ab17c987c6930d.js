webpackJsonp([32],{"8V1m":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"line-height":"30px","margin-bottom":"10px"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},on:{change:e.handleGradeChange1},model:{value:e.gradeValue,callback:function(t){e.gradeValue=t},expression:"gradeValue"}},e._l(e.gradeSimpleVMs,function(e){return a("el-option",{key:e.gradeValue,attrs:{label:e.gradeName,value:e.gradeValue}})})),e._v(" "),a("el-select",{staticStyle:{width:"120px",margin:"0 10px"},attrs:{placeholder:"请选择"},on:{change:e.handleGradeChangeCourse},model:{value:e.courseValue,callback:function(t){e.courseValue=t},expression:"courseValue"}},e._l(e.courseList,function(e){return a("el-option",{key:e.courseValue,attrs:{label:e.name,value:e.courseValue}})}))],1),e._v(" "),a("div",{staticClass:"count-tabscon"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-card",{staticStyle:{"min-height":"440px"}},[a("el-tree",{staticStyle:{border:"0",height:"100%"},attrs:{data:e.catalogTreeData,"node-key":"id",props:e.defaultProps,"default-expanded-keys":[e.defaultKey],"current-node-key":e.defaultKey,"highlight-current":"","default-expand-all":!1},on:{"node-click":e.handleNodeClick}})],1)],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-card",[0!=e.showData.resVMs.length?a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"视频资源",name:"1"}},e._l(e.showData.resVMs,function(t){return a("div",{key:t.resId,staticClass:"tpl-sl-rows cp",on:{click:function(a){e.handleResClick(t)}}},[a("i",{staticClass:"fa fa-film",attrs:{"aria-hidden":"true"}}),e._v(" "),a("span",{staticClass:"tpl-sl-title"},[e._v(e._s(t.resName))])])}))],1):e._e(),e._v(" "),0!=e.showData.hwVMs.length?a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"作业资源",name:"1"}},e._l(e.showData.hwVMs,function(t){return a("div",{key:t.hwId,staticClass:"tpl-sl-rows cp",on:{click:function(a){e.handleHwClick(t)}}},[a("i",{staticClass:"fa fa-file-text",attrs:{"aria-hidden":"true"}}),e._v(" "),a("span",{staticClass:"tpl-sl-title"},[e._v(e._s(t.hwName))])])}))],1):e._e(),e._v(" "),0==e.showData.resVMs.length&&0==e.showData.hwVMs.length?a("p",{staticClass:"center",staticStyle:{"line-height":"400px",color:"#ccc"}},[e._v("暂无数据")]):e._e()],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",[a("div",{ref:"myChart1",staticClass:"sl-myChart2"})])],1)],1)],1)])},staticRenderFns:[]}},F67R:function(e,t){},Np5o:function(e,t,a){var s=a("VU/8")(a("RPT2"),a("8V1m"),function(e){a("F67R")},null,null);e.exports=s.exports},RPT2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("bOdI"),r=a.n(s),i=a(10),n=a.n(i),l=a("6kVi");t.default={data:function(){return{defaultProps:{children:"children",label:"name"},activeName:"1",defaultKey:"",courseMap:{},gradeSimpleVMs:[],courseList:[],gradeValue:"",courseValue:"",myChart1:null,option1:{backgroundColor:"#fff",title:{text:"",x:"center",y:"87.5%"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{x:"center",y:"80%",data:["已完成","未完成"]},series:[{name:"",type:"pie",radius:["30%","50%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"16",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:[]}],color:["#ffcb6b","#ff6666"]},catalogTreeData:[],showData:{resVMs:[],hwVMs:[]},courseName:""}},created:function(){this.init()},methods:{init:function(){this.getGC()},handleResClick:function(e){var t=this;this.myChart1&&(this.myChart1.clear(),this.myChart1.showLoading()),a.i(l.e)({resId:e.resId,gradeValue:this.gradeValue}).then(function(e){t.drawchart1(e)})},handleHwClick:function(e){var t=this;this.myChart1&&(this.myChart1.clear(),this.myChart1.showLoading()),a.i(l.f)({hwId:e.hwId,gradeValue:this.gradeValue}).then(function(e){t.drawchart1(e)})},drawchart1:function(e){var t=this;this.option1.title.text=this.courseName+"科目完成情况分布图",this.option1.series[0].name=this.courseName+"科目完成情况分布图",this.option1.series[0].data=[{value:e.complete,name:"已完成"},{value:e.unfinished,name:"未完成"}],this.myChart1.setOption(this.option1),setTimeout(function(){t.myChart1.hideLoading()},10)},getGC:function(){var e=this;a.i(l.g)({unitId:this.$store.state.unitId}).then(function(t){e.gradeSimpleVMs=t.gradeSimpleVMs||[],e.courseMap=t.courseMap||{},e.gradeValue=e.gradeSimpleVMs.length>0?e.gradeSimpleVMs[0].gradeValue:""}).catch(function(e){})},handleGradeChange1:function(e){var t=this;this.courseList=[],this.courseValue="";var a="";this.gradeSimpleVMs.forEach(function(t,s){t.gradeValue==e&&(a=t.id)}),setTimeout(function(){t.courseList=t.courseMap[a],t.courseValue=t.courseList.length>0?t.courseList[0].courseValue:""},50)},handleGradeChangeCourse:function(e){var t=this;this.showData.hwVMs=[],this.showData.resVMs=[],this.courseName="",this.courseList.forEach(function(a,s){a.courseValue==e&&(t.courseName=a.name)}),this.getCatalogTree()},handleNodeClick:function(e){this.showData.hwVMs=[],this.showData.resVMs=[],e&&(this.showData.resVMs=e.resVMs||[],this.showData.hwVMs=e.hwVMs||[])},getCatalogTree:function(){var e=this;this.catalogTreeData=[],""!==this.courseValue&&""!==this.gradeValue&&a.i(l.h)({courseValue:this.courseValue,gradeValue:this.gradeValue}).then(function(t){t&&t.forEach(function(e,a){e.resourceInfoVM&&e.resourceInfoVM.forEach(function(t,a){t.name=t.resName,t.sltype="rc",t.id=t.resId,t.parentId=e.id,t.parentName=e.name}),e.parentId||e.resourceInfoVM&&e.resourceInfoVM.forEach(function(a,s){a.name=a.resName,a.sltype="rc",a.parentId=e.id,a.parentName=e.name,t.push(a)})}),e.catalogTreeData=e.data2tree(t)}).catch(function(e){})},data2tree:function(e,t,a){t||(t="id"),a||(a="parentId");for(var s=[],i=0;i<e.length;i++){var n=_.cloneDeep(e[i]);(n[a+""]||""==n[a+""])&&_.result(_.find(e,r()({},t,n[a+""])),t)||(function s(r){for(var i=[],n=0;n<e.length;n++){var l=_.cloneDeep(e[n]);l[a+""]==r[t+""]&&(i.push(l),s(l))}i.length&&(r.children=i)}(n),s.push(n))}return s}},mounted:function(){this.$refs.myChart1&&(this.myChart1=n.a.init(this.$refs.myChart1),this.myChart1.setOption(this.option1))}}}});