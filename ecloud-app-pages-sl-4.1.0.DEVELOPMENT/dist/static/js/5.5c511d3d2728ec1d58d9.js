webpackJsonp([5],{"5Swp":function(e,t,a){var s=a("VU/8")(a("XRJc"),a("UvPD"),null,null,null);e.exports=s.exports},"6G3N":function(e,t,a){"use strict";var s=a("Dd8w"),i=a.n(s),l=a("mvHQ"),o=a.n(l),r=a("bOdI"),n=a.n(r),d=a("HU6I"),h=a("YE7g");t.a={name:"Upload",props:{data:{type:Object,default:{}}},data:function(){var e;return e={courseType:"type1",catalog:"点击选择",gradeValue:"",catalogId:"",schooltermType:"",stageId:"",isShowCatalogError:!1,catalogErrorText:"编目不能为空！",courses:[],courseValue:"",coursesDialog:!1,catalogTreeData:[],defaultChecked:[],emptyTextCatalogTree:"正在加载中...",treeNode:void 0,addNewBtn:!1,isExpendAll:!0,emptyText:"正在加载中...",objTable1:{resourceType:"",knowledge:"点击选择",knowledgeId:"",fileAuthor:"",fileName:"",uploadValue:"",percentage:"0",isShowProgress:!1,isShow:!1,fileId:"",fileType:"",suffix:"",fileSize:"",deleteColumnDisabled:"",isShowResourceTypeError:!1,isShowRcFileNameError:!1,isShowfileNameError:!1,resourceTypeErrorText:"资源分类不能为空！",rcFileNameErrorText:"为空！",isUploadBtn:!0,isErrorProgress:!1,isProgress:!1,fileNameErrorText:"请先上传文件!"},tableData1:[],currentColumn:d.a.currentColumn,rcTypess:[],tableDataIndexKnowledge:0,choseNnowledgelDialog:!1,nowledgelTreeData:[],nowledgelChecked:[],deleteColumnDialog:!1,uploadFileSize:0,uploadNumber:0,addColumnDisabled:!1,uploadText:"添加",tableDataIndex:0,tableDataKeys:{},isScuessUpload:{},uploadData:{serverid:"rc"},uploadAction:window.ShiYue.base+"/zuul/api/storage/upload",tableData2:d.a.tableData2,rcName:"",isShowRcNameError:!1},n()(e,"deleteColumnDialog",!1),n()(e,"column",""),n()(e,"authorName",this.$store.state.realName?this.$store.state.realName:"点击选择(只能有一个上传人)"),n()(e,"userId",this.$store.state.userId?this.$store.state.userId:""),n()(e,"isShowAuthorNameError",!1),n()(e,"checkList",[]),n()(e,"labelName","点击选择已有标签"),n()(e,"label",""),n()(e,"labels",[]),n()(e,"choseLabelDialog",!1),n()(e,"tag",""),n()(e,"jianjie",""),n()(e,"downloadControl","0"),n()(e,"sharedScope",2),n()(e,"isSubmitAndUpload",!1),n()(e,"isSubmitAndClose",!1),e},created:function(){this.getResourceTypeList(),this.getRoutineManage(),"{}"!=o()(this.data)&&(this.gradeValue=this.data.gradeValue,this.courseValue=this.data.courseValue,this.catalogId=this.data.id,this.catalog=this.data.name,this.schooltermType=this.data.schooltermType,this.stageId=this.data.stageId)},methods:{getRoutineManage:function(){var e=this;a.i(h.a)().then(function(t){t&&"ok"==t.code&&t.data?(e.uploadFileSize=t.data.uploadFileSize,e.uploadNumber=t.data.uploadNumber,e.uploadNumber<2&&(e.addColumnDisabled=!0)):e.addColumnDisabled=!0})},getResourceTypeList:function(){var e=this,t=[];a.i(h.b)("type1").then(function(a){a&&"ok"==a.code&&a.data&&a.data.length>0?(a.data.forEach(function(e){t.push({text:e.name,value:e.id})}),e.rcTypess=t,e.tableData1.push(e.objTable1),e.tableData1.forEach(function(t,a){e.tableData1[a].resourceType=e.rcTypess[0].value})):(e.tableData1.push(e.objTable1),e.rcTypess=[])})},choseCatalog:function(){var e=this;this.coursesDialog=!0,this.catalogTreeData=[],this.emptyText="正在加载中...",this.emptyTextCatalogTree="正在加载中...",this.addNewBtn=!1,this.courseValue?this.getCataloglList({courseValue:this.courseValue,gradeValue:this.gradeValue,schooltermType:this.term}):a.i(h.c)().then(function(t){t&&"ok"==t.code&&null==t.fieldErrors&&t.data&&t.data.length>0?(t.data.forEach(function(t){null!=t.parentId&&"course_type"!=t.type&&e.courses.push({value:t.value,name:t.name}),0==e.courses.length&&(e.emptyText="暂无数据",e.emptyTextCatalogTree="暂无数据")}),e.courseValue?e.courseValue&&e.getCataloglList({courseValue:e.courseValue,gradeValue:e.gradeValue,schooltermType:e.term}):e.courses.length>0&&a.i(h.d)({year:e.year?e.year:void 0,schoolTerm:e.term}).then(function(t){if(t&&200===t.status&&t.data&&t.data.length>0){for(var a=0;a<t.data.length;a++)for(var s=0;s<e.courses.length;s++)if(t.data[a].courseValue==e.courses[s].value)return e.courseValue=e.courses[s].value,e.curIndex=s,e.getCataloglList({courseValue:e.courseValue,gradeValue:e.gradeValue,schooltermType:e.term}),!1}else e.curIndex=0,e.courses.length>0&&(e.courseValue=e.courses[0].value,e.getCataloglList({courseValue:e.courseValue,gradeValue:e.gradeValue,schooltermType:e.term}))})):e.emptyText="暂无数据"})},courseName:function(e,t){this.curIndex=t,this.courseValue=e,this.getCataloglList({courseValue:this.courseValue,gradeValue:this.gradeValue,schooltermType:this.term})},getCataloglList:function(e){var t=this;this.defaultChecked=[],this.emptyTextCatalogTree="正在加载中...";var s=[];a.i(h.e)(e).then(function(e){if(e&&200==e.status&&e.data&&e.data.length>0){if(e.data.forEach(function(e){null!=e.parentId&&s.push({name:e.name,id:e.id,parentId:e.parentId,children:[],schooltermType:e.schooltermType,stageId:e.stageId,path:e.path,courseValue:e.courseValue,gradeValue:e.gradeValue,nocheck:!(e.path.split("/").length>2)})}),t.catalogTreeData=s,0==t.catalogTreeData.length)return t.emptyTextCatalogTree="暂无数据",!1;void 0==t.treeNode?t.defaultChecked=[]:t.catalogTreeData.forEach(function(e){e.id==t.treeNode.id&&t.defaultChecked.push(t.treeNode.id)})}else t.emptyTextCatalogTree="暂无数据"})},checkedCourses:function(e){this.treeNode=e.allCeckNodes[0]},submitCourses:function(){void 0==this.treeNode?(this.catalog="点击选择",this.catalogId="",this.isShowCatalogError=!0):(this.isShowCatalogError=!1,this.catalog=this.treeNode.name,this.catalogId=this.treeNode.id,this.schooltermType=this.treeNode.schooltermType,this.stageId=this.treeNode.stageId),this.addNewBtn=!0,this.coursesDialog=!1},resourceTypeChange:function(e){this.tableData1[e].resourceType!=this.rcTypess[0].value?this.tableData1[e].deleteColumnDisabled=!1:this.tableData1.length>1?this.tableData1[e].deleteColumnDisabled=!1:this.tableData1[e].deleteColumnDisabled=!0},choseNnowledge:function(e){var t=this;this.addNewBtn=!1,this.gradeValue?(this.choseNnowledgelDialog=!0,this.tableDataIndexKnowledge=e,this.knowpointTree=[],this.emptyText="正在加载中...",a.i(h.f)({unitId:this.$store.state.unitId,gradeValue:this.gradeValue,courseValue:this.courseValue}).then(function(e){t.nowledgelTreeData=[],e&&"ok"==e.code&&e.data&&e.data.length>0?(e.data.forEach(function(e){null!=e.parentPointId?t.nowledgelTreeData.push({id:e.id,name:e.name,parentId:e.parentPointId,children:[]}):t.nowledgelTreeData.push({id:e.id,name:e.name,parentId:e.parentPointId,children:[],nocheck:!0})}),t.tableData1[t.tableDataIndexKnowledge].knowledge?t.nowledgelChecked.push(t.tableData1[t.tableDataIndexKnowledge].knowledgeId):t.nowledgelChecked=[]):t.emptyText="暂无数据"})):this.$notify.info({title:"提示",message:"请先选择编目才能选择知识点"})},checkedNode:function(e){this.tableData1[this.tableDataIndexKnowledge].currentNode=e.allCeckNodes[0]},submitNnowledge:function(){void 0==this.tableData1[this.tableDataIndexKnowledge].currentNode?(this.tableData1[this.tableDataIndexKnowledge].knowledge="点击选择",this.tableData1[this.tableDataIndexKnowledge].knowledgeId="",this.$notify.info({title:"提示",message:"您没有选择知识点"})):"{}"!=o()(this.tableData1[this.tableDataIndexKnowledge].currentNode)&&(this.tableData1[this.tableDataIndexKnowledge].knowledge=this.tableData1[this.tableDataIndexKnowledge].currentNode.name,this.tableData1[this.tableDataIndexKnowledge].knowledgeId=this.tableData1[this.tableDataIndexKnowledge].currentNode.id),"点击选择"!=this.tableData1[this.tableDataIndexKnowledge].knowledge?this.tableData1[this.tableDataIndexKnowledge].deleteColumnDisabled=!1:this.tableData1[this.tableDataIndexKnowledge].deleteColumnDisabled=!0,this.choseNnowledgelDialog=!1,this.addNewBtn=!0},rcFileNameKeyupEnter:function(e){if(this.tableData1[e].fileName){this.rcName||(this.rcName=this.tableData1[e].fileName),this.tableData1[e].isShowRcFileNameError=!1;for(var t=0;t<this.tableData1.length;t++)if(e!=t){if(this.tableData1[e].fileName===this.tableData1[t].fileName){this.tableData1[e].isShowRcFileNameError=!0,this.tableData1[e].rcFileNameErrorText="重复";break}this.tableData1[e].isShowRcFileNameError=!1,this.tableData1[e].deleteColumnDisabled=!1}}else this.tableData1[e].isShowRcFileNameError=!0,this.tableData1[e].rcFileNameErrorText="为空!"},handleuPLOAD:function(e){this.tableDataIndex=1*e+1+"",this.tableData1[this.tableDataIndex-1].isShowProgress?this.tableData1[this.tableDataIndex-1].isShowProgress=!0:this.tableData1[this.tableDataIndex-1].isShowProgress=!1,this.tableData1[this.tableDataIndex-1].isErrorProgress?this.tableData1[this.tableDataIndex-1].isErrorProgress=!0:this.tableData1[this.tableDataIndex-1].isErrorProgress=!1},beforeUpload:function(e){return".mp4"!=/\.[^\.]+$/.exec(e.name)[0]?(this.tableData1[this.tableDataKeys[e.uid+""]-1].isShowfileNameError=!0,this.tableData1[this.tableDataKeys[e.uid+""]-1].fileNameErrorText="禁止上传此类型文件,只能上传mp4格式的文件",this.tableData1[this.tableDataKeys[e.uid+""]-1].isUploadBtn=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].isProgress=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].isErrorProgress=!0,!1):this.uploadFileSize<e.size/1048576?(this.tableData1[this.tableDataKeys[e.uid+""]-1].isErrorProgress=!0,this.tableData1[this.tableDataKeys[e.uid+""]-1].isShowfileNameError=!0,this.tableData1[this.tableDataKeys[e.uid+""]-1].isProgress=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].fileNameErrorText="上传的资源已超过设置的最大上传"+this.uploadFileSize+"MB",!1):void 0},submitUpload:function(e){var t=[];t.push(this.$refs[e][0].uploadFiles[this.$refs[e][0].uploadFiles.length-1]),this.$refs[e][0].uploadFiles=t,this.$refs[e][0].submit(),this.tableData1[e.split("_")[1]].percentage="0%",this.tableData1[e.split("_")[1]].isShowProgress=!1,this.tableData1[e.split("_")[1]].isUploadBtn=!1},onChange:function(e,t){if(!this.tableDataKeys[e.uid+""]&&!this.isScuessUpload[e.uid+""])return this.tableDataKeys[e.uid+""]=this.tableDataIndex,this.tableData1[this.tableDataKeys[e.uid+""]-1].uploadValue=e.name,this.tableData1[this.tableDataKeys[e.uid+""]-1].isShowfileNameError=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].isUploadBtn=!0,this.tableData1[this.tableDataKeys[e.uid+""]-1].isProgress=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].isErrorProgress=!1,this.tableData1[this.tableDataKeys[e.uid+""]-1].isShowProgress=!1,void(this.tableData1[this.tableDataKeys[e.uid+""]-1].uploadValue&&(this.tableData1[this.tableDataKeys[e.uid+""]-1].deleteColumnDisabled=!1))},onProgress:function(e,t){this.isScuessUpload[t.uid+""]=!1,this.tableData1[this.tableDataKeys[t.uid+""]-1].percentage=Math.round(t.percentage)+"%",this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowProgress=!1,this.tableData1[this.tableDataKeys[t.uid+""]-1].isProgress=!0,this.tableData1[this.tableDataKeys[t.uid+""]-1].isUploadBtn=!1},onSuccess:function(e,t,a){this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowProgress=!0,e&&"200"==e.status?(this.isScuessUpload[t.uid+""]=!0,e.data&&(this.tableData1[this.tableDataKeys[t.uid+""]-1].fileId=e.data.id,this.tableData1[this.tableDataKeys[t.uid+""]-1].fileType=e.data.fileType,this.tableData1[this.tableDataKeys[t.uid+""]-1].suffix=e.data.suffix,this.tableData1[this.tableDataKeys[t.uid+""]-1].fileSize=e.data.fileSize,this.$notify({title:"提示",message:"上传成功！",type:"success"}),this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowfileNameError=!1,this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowRcFileNameError=!1,this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName||(this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName=t.name),this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName.length>50&&(this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowRcFileNameError=!0,this.tableData1[this.tableDataKeys[t.uid+""]-1].rcFileNameErrorText="超过50个字"),this.rcName||(this.rcName=this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName.match(/(.*)\.[^.]+/)[1],this.isShowRcNameError=!1),this.tableData1[this.tableDataKeys[t.uid+""]-1].isShowProgress=!0)):(this.tableData1[this.tableDataIndex-1].isProgress=!1,this.tableData1[this.tableDataKeys[t.uid+""]-1].isErrorProgress=!0,this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName=""),this.tableData1[this.tableDataKeys[t.uid+""]-1].fileName?this.tableData1[this.tableDataKeys[t.uid+""]-1].deleteColumnDisabled=!1:this.tableData1[this.tableDataKeys[t.uid+""]-1].deleteColumnDisabled=!0},deleteColumn:function(e){this.column=e,this.deleteColumnDialog=!0},submitDeleteColumn:function(){this.uploadText="添加",this.$refs["upload_"+this.column][this.column].abort(),this.tableData1[this.column].isShowfileNameError=!1,this.tableData1[this.column].fileNameErrorText="请先上传文件!",this.tableData1[this.column].deleteColumnDisabled=!0,this.tableData1[this.column].isUploadBtn=!0,this.tableData1[this.column].isErrorProgress=!1,this.tableData1[this.column].isProgress=!1,this.tableData1.length>1?(this.tableData1.splice(this.column,1),this.tableData1.length<this.uploadNumber&&(this.addColumnDisabled=!1),1==this.tableData1.length&&(0!=this.column?this.tableData1[this.column-1].resourceType!=this.rcTypess[0].value||this.tableData1[this.column-1].knowledge||this.tableData1[this.column-1].fileAuthor||this.tableData1[this.column-1].fileName||this.tableData1[this.column-1].uploadValue?this.tableData1[this.column-1].deleteColumnDisabled=!1:this.tableData1[this.column-1].deleteColumnDisabled=!0:this.tableData1[this.column].resourceType!=this.rcTypess[0].value||this.tableData1[this.column].knowledge||this.tableData1[this.column].fileAuthor||this.tableData1[this.column].fileName||this.tableData1[this.column].uploadValue?this.tableData1[this.column].deleteColumnDisabled=!1:this.tableData1[this.column].deleteColumnDisabled=!0)):1==this.tableData1.length&&(this.tableData1[this.column].resourceType!=this.rcTypess[0].value||this.tableData1[this.column].knowledge||this.tableData1[this.column].fileAuthor||this.tableData1[this.column].fileName||this.tableData1[this.column].uploadValue)&&(this.tableData1[this.column].resourceType=this.rcTypess[0].value,this.tableData1[this.column].knowledge="点击选择",this.tableData1[this.column].fileAuthor="",this.tableData1[this.column].fileName="",this.tableData1[this.column].uploadValue="",this.tableData1[this.column].fileId="",this.tableData1[this.column].fileType="",this.tableData1[this.column].suffix="",this.tableData1[this.column].fileSize=""),this.deleteColumnDialog=!1},addColumn:function(){this.tableData1[this.tableData1.length-1].deleteColumnDisabled=!1;var e=this.tableData1[this.tableData1.length-1];this.tableData1.length<this.uploadNumber&&(this.addColumnDisabled=!1,this.tableData1.push({resourceType:e?e.resourceType:"",knowledge:"点击选择",fileAuthor:"",fileName:"",knowledgeId:"",uploadValue:"",percentage:"0",isShowProgress:!1,isShow:!1,fileId:"",fileType:"",suffix:"",fileSize:"",isShowResourceTypeError:!1,isShowRcFileNameError:!1,isShowfileNameError:!1,resourceTypeErrorText:"资源分类不能为空！",rcFileNameErrorText:"为空！",isUploadBtn:!0,isErrorProgress:!1,isProgress:!1,fileNameErrorText:"请先上传文件!"}),this.tableData1.length==this.uploadNumber&&(this.addColumnDisabled=!0,this.uploadText="已达最大增加数",this.$notify.info({title:"提示",message:"已达到增加资源的最大"+this.uploadNumber+"条限制条数"})))},choseUploadUser:function(){var e=this,t=[];t.push(this.userId),this.$SelectUsers({selectUserType:2,unitId:this.$store.state.unitId,selectUserIds:t},function(t,a){if(t.length>1)return e.$notify({title:"警告",message:"最多选择一个上传人！",type:"warning"}),!0;1==t.length?(e.authorName=t[0].realName,e.userId=t[0].id,e.isShowAuthorNameError=!1):(e.userId="",e.authorName="点击选择",e.isShowAuthorNameError=!0)})},getLabelList:function(){var e=this;this.labels=[],this.emptyText="正在加载中...",a.i(h.g)().then(function(t){if(t&&"200"==t.status&&t.data&&t.data.length>0){var a=[],s=[];t.data.forEach(function(t){e.labels.push({id:t.id,name:t.name}),e.checkList&&e.checkList.length>0&&e.checkList.forEach(function(e){e==t.id&&(a.push(t.name),s.push(t.id))})}),e.labelName=a.join(","),e.label=s.join(",")}else e.emptyText="暂无数据";e.addNewBtn=!1})},choseLabel:function(){this.choseLabelDialog=!0,this.getLabelList()},submitLabel:function(){var e=this,t=[];this.checkList&&this.checkList.length>0?(this.checkList.forEach(function(a){t.push(_.find(e.labels,{id:a}))}),this.labelName=_.map(t,"name").join(","),this.label=this.checkList.join(","),this.choseLabelDialog=!1):(this.labelName="",this.label="",this.choseLabelDialog=!1,this.$notify.info({title:"提示",message:"您没有选择任何标签"}))},_init:function(){this.treeNode=void 0,this.curIndex=0,this.cValue||(this.courseValue=""),this.cId||(this.catalog="点击选择",this.catalogId=""),this.defaultChecked=[],this.nowledgelChecked=[],this.tableData1=[],this.tableData1.push({resourceType:this.rcTypess.length>0?this.rcTypess[0].value:"",knowledge:"点击选择",knowledgeId:"",fileAuthor:"",fileName:"",uploadValue:"",percentage:"0",isShowProgress:!1,isShow:!1,fileId:"",fileType:"",suffix:"",fileSize:"",deleteColumnDisabled:"",isShowResourceTypeError:!1,isShowRcFileNameError:!1,isShowfileNameError:!1,resourceTypeErrorText:"资源分类不能为空！",rcFileNameErrorText:"为空！",isUploadBtn:!0,isErrorProgress:!1,isProgress:!1,fileNameErrorText:"请先上传文件!"}),this.rcName="",this.authorName=this.$store.state.realName,this.labelName="点击选择已有标签",this.checkList=[],this.label="",this.labels=[],this.tag="",this.jianjie="",this.authorName=this.$store.state.realName?this.$store.state.realName:"点击选择(只能有一个上传人)",this.userId=this.$store.state.userId?this.$store.state.userId:"",this.downloadControl="0"},saveBaseRc:function(e,t){var s=this;a.i(h.h)(e,t).then(function(e){"error"==e||"200"!=e.status?s.$notify.error({rcName:"错误",message:"上传资源出错"}):"200"==e.status&&(s.$notify({title:"成功",message:"提交并上传成功",type:"success"}),s.$emit("upload-submit",{id:e.data,name:s.rcName}))})},uploadValidate:function(){var e=this;"点击选择"==this.catalog&&(this.isShowCatalogError=!0),this.rcName||(this.isShowRcNameError=!0),"点击选择"==this.authorName&&(this.isShowAuthorNameError=!0);var t={};this.tableData1.forEach(function(a,s){a.resourceType||(e.tableData1[s].isShowResourceTypeError=!0),a.fileName?a.fileName.length>50&&(e.tableData1[s].isShowRcFileNameError=!0,e.tableData1[s].rcFileNameErrorText="超过50个字"):e.tableData1[s].isShowRcFileNameError=!0,a.fileId||(e.tableData1[s].isShowfileNameError=!0),t["files["+s+"].resourceType"]=a.resourceType,t["files["+s+"].fileName"]=a.fileName,t["files["+s+"].fileId"]=a.fileId,t["files["+s+"].suffix"]=a.suffix,t["files["+s+"].fileType"]=a.fileType,t["files["+s+"].fileSize"]=a.fileSize,t["files["+s+"].knowledgeId"]=a.knowledgeId,t["files["+s+"].fileAuthor"]=a.fileAuthor});var a=i()({courseType:this.courseType,publicId:this.courseType,catalogId:this.catalogId,gradeValue:this.gradeValue,courseValue:this.courseValue,termValue:this.schooltermType,stageId:this.stageId,"detailedVM.brief":this.jianjie?this.jianjie:"",createUser:this.userId,userName:this.authorName,resTag:this.tag,labels:this.label,name:this.rcName,"detailedVM.downloadControl":this.downloadControl,sharedScope:this.sharedScope,appId:this.$route.query.topicId,appPk:this.$route.query.appPk},t),s=0;if(this.rcName&&this.authorName)for(var l=0;l<this.tableData1.length;l++)this.tableData1[l].resourceType&&this.tableData1[l].fileName&&this.tableData1[l].fileName.length<=50&&this.tableData1[l].fileId&&s++;if(s==this.tableData1.length&&"点击选择"!=this.catalog)return a},submitAndUpload:function(){var e=this.uploadValidate();e&&this.saveBaseRc(e)}}}},HU6I:function(e,t,a){"use strict";t.a={currentColumn:[{prop:"rcType",label:"资源分类",align:"center",width:"160"},{prop:"knowledge",label:"知识点",align:"center",width:"100"},{prop:"fileAuthor",label:"作者",align:"center",width:"100"},{prop:"fileName",label:"资源名称（小于50字）",align:"center",width:""},{prop:"uploadValue",label:"上传文件",align:"center",width:"280"}],tableData2:[{id:"cell1",name:"标题"},{id:"cell2",name:"上传人"},{id:"cell3",name:"标签"},{id:"cell4",name:"简介"},{id:"cell5",name:"下载控制"}]}},UvPD:function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sy-upload-page"},[a("div",{staticClass:"sy-note-upload-form"},[a("table",{staticClass:"sy-upload-page-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[a("tr",[a("td",{attrs:{width:"12%"}},[e._v("第一步：资源目录")]),e._v(" "),a("td",[a("span",{staticClass:"sy-lf center"},[e._v("基础型课程")]),e._v(" "),a("div",{staticClass:"sy-upload-page-row1 left"},["{}"!=JSON.stringify(this.data)?a("el-tag",{attrs:{type:"primary"}},[e._v(e._s(e.catalog))]):a("div",{class:{"el-input__inner":!0,cp:!0,borderRed:e.isShowCatalogError},on:{click:e.choseCatalog}},[e._v("\n                            "+e._s(e.catalog)+"\n                        ")]),e._v(" "),e.isShowCatalogError?a("span",{staticClass:"errorMsg",staticStyle:{bottom:"-24px"}},[e._v(e._s(e.catalogErrorText))]):e._e()],1)])]),e._v(" "),a("tr",[a("td",[e._v("第二步：上传资源")]),e._v(" "),a("td",{attrs:{align:"left"}},[a("el-table",{staticClass:"step2 mb5",staticStyle:{width:"100%"},attrs:{data:e.tableData1,"empty-text":e.emptyText}},e._l(e.currentColumn,function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,align:t.align},scopedSlots:e._u([{key:"default",fn:function(s){return["rcType"===t.prop?a("div",[a("el-select",{class:{borderRed:s.row.isShowResourceTypeError},on:{change:function(t){e.resourceTypeChange(s.$index)}},model:{value:s.row.resourceType,callback:function(e){s.row.resourceType=e},expression:"scope.row.resourceType"}},e._l(e.rcTypess,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),e._v(" "),s.row.isShowResourceTypeError?a("span",{staticClass:"errorMsg"},[e._v(e._s(s.row.resourceTypeErrorText))]):e._e()],1):"knowledge"===t.prop?a("div",{staticClass:"el-input__inner cp",on:{click:function(t){e.choseNnowledge(s.$index)}}},[e._v("\n                                    "+e._s(s.row.knowledge)+"\n                                ")]):"fileAuthor"===t.prop?a("el-input",{attrs:{size:"small",placeholder:"最长10个字",maxlength:10},model:{value:s.row.fileAuthor,callback:function(e){s.row.fileAuthor="string"==typeof e?e.trim():e},expression:"scope.row.fileAuthor"}}):"fileName"===t.prop?a("div",[a("el-input",{class:{borderRed:s.row.isShowRcFileNameError},attrs:{size:"small",placeholder:"最长50个字",maxlength:50},on:{blur:function(t){e.rcFileNameKeyupEnter(s.$index)}},model:{value:s.row.fileName,callback:function(e){s.row.fileName="string"==typeof e?e.trim():e},expression:"scope.row.fileName"}}),e._v(" "),s.row.isShowRcFileNameError?a("span",{staticClass:"errorMsg"},[e._v("资源名称不能"+e._s(s.row.rcFileNameErrorText))]):e._e()],1):"uploadValue"===t.prop?a("div",[a("el-upload",{ref:"upload_"+s.$index,refInFor:!0,staticClass:"sy-lf sy-import",attrs:{"on-change":e.onChange,"on-progress":e.onProgress,data:e.uploadData,action:e.uploadAction,"before-upload":e.beforeUpload,"on-success":e.onSuccess,"auto-upload":!1,"show-file-list":!1,name:"fileUpload",disabled:(s.$index,!1)}},[a("div",{staticClass:"sy-import-file-name el-input__inner",class:{borderRed:s.row.isShowfileNameError},on:{click:function(t){e.handleuPLOAD(s.$index)}},slot:"trigger"},[a("div",{staticClass:"sy-import-file-name-div"},[e._v(e._s(s.row.uploadValue))]),e._v(" "),a("span",{staticClass:"fa fa-folder-o"})])]),e._v(" "),a("span",{staticClass:"sy-note-progress"},[s.row.isUploadBtn?a("el-button",{attrs:{type:"primary",disabled:""==s.row.uploadValue,size:"small"},on:{click:function(t){e.submitUpload("upload_"+s.$index)}}},[e._v("\n                                            上传\n                                        ")]):e._e(),e._v(" "),s.row.isProgress?a("span",[s.row.isShowProgress?e._e():a("span",{attrs:{title:"正在上传..."}},[e._v(e._s(s.row.percentage))]),e._v(" "),s.row.isShowProgress?a("i",{staticClass:"fontLv el-icon-circle-check",attrs:{title:"上传成功"}}):e._e()]):e._e(),e._v(" "),s.row.isErrorProgress?a("i",{staticClass:"sy-error-progress fa fa-info-circle ",attrs:{title:"上传出错"}}):e._e()],1),e._v(" "),s.row.isShowfileNameError?a("span",{staticClass:"errorMsg"},[e._v(e._s(s.row.fileNameErrorText))]):e._e(),e._v(" "),a("el-button",{staticClass:"sy-import-button",attrs:{type:"danger",size:"small",disabled:s.row.deleteColumnDisabled},on:{click:function(t){e.deleteColumn(s.$index)}}},[e._v("\n                                        删除\n                                    ")])],1):e._e()]}}])})})),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",disabled:e.addColumnDisabled},on:{click:e.addColumn}},[e._v("\n                        "+e._s(e.uploadText)+"\n                    ")])],1)]),e._v(" "),a("tr",[a("td",[e._v("第三步：资源属性")]),e._v(" "),a("td",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData2}},[a("el-table-column",{attrs:{prop:"name",label:"属性分类",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"n",label:"内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["cell1"===t.row.id?a("div",[a("el-input",{class:{borderRed:e.isShowRcNameError},attrs:{size:"small",placeholder:"最长50个字",maxlength:50},on:{blur:e.rcNameKeyupEnter,keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.rcNameKeyupEnter(t)}},model:{value:e.rcName,callback:function(t){e.rcName="string"==typeof t?t.trim():t},expression:"rcName"}}),e._v(" "),e.isShowRcNameError?a("span",{staticClass:"errorMsg"},[e._v("标题不能为空!")]):e._e()],1):"cell2"===t.row.id?a("div",{staticClass:"left"},[a("div",{class:{"el-input__inner":!0,cp:!0,borderRed:e.isShowAuthorNameError},staticStyle:{width:"30%"},on:{click:e.choseUploadUser}},[e._v("\n                                        "+e._s(e.authorName)+"\n                                    ")]),e._v(" "),e.isShowAuthorNameError?a("span",{staticClass:"errorMsg"},[e._v("上传人不能为空!")]):e._e()]):"cell3"===t.row.id?a("div",{staticClass:"left"},[a("div",{staticClass:"el-input el-input__inner cp",staticStyle:{width:"30%"},on:{click:e.choseLabel}},[e._v(e._s(e.labelName))]),e._v(" "),a("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",placeholder:"自定义标签（只能有一个,最大长度50）",maxlength:50},model:{value:e.tag,callback:function(t){e.tag="string"==typeof t?t.trim():t},expression:"tag"}})],1):"cell4"===t.row.id?a("el-input",{staticStyle:{margin:"5px 0"},attrs:{type:"textarea",rows:7,resize:"none",placeholder:"最大输入长度为500",maxlength:500},model:{value:e.jianjie,callback:function(t){e.jianjie=t},expression:"jianjie"}}):"cell5"===t.row.id?a("div",{staticClass:"left"},[a("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:e.downloadControl,callback:function(t){e.downloadControl=t},expression:"downloadControl"}},[e._v("允许下载")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:e.downloadControl,callback:function(t){e.downloadControl=t},expression:"downloadControl"}},[e._v("不允许下载")])],1):e._e()]}}])})],1)],1)]),e._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("div",{staticClass:"pl15 center sy-rc-btn-goTop"},[a("el-button",{staticClass:"sy-import-button",attrs:{type:"primary",size:"small",disabled:e.isSubmitAndUpload},on:{click:e.submitAndUpload}},[e._v("\n                            提交\n                        ")])],1)])])])]),e._v(" "),a("sy-dialog",{attrs:{"append-to-body":"",title:"选择学科","close-on-click-modal":!1,position:"middle",width:"600px",height:"380px",slide:"fade",visible:e.coursesDialog},on:{"update:visible":function(t){e.coursesDialog=t}}},[a("div",{staticClass:"sy-upload-page-chose-courses",slot:"body"},[e.cValue?e._e():a("div",{staticClass:"sy-upload-page-courses-list sy-theme-border"},[a("div",{staticClass:"sy-upload-page-courses-list-title sy-theme-background"},[e._v("学科")]),e._v(" "),a("div",{staticClass:"sy-upload-page-courses-list-cont"},[e.courses&&e.courses.length>0?a("ul",e._l(e.courses,function(t,s){return a("li",{key:t.value,staticClass:"sy-theme-border",on:{click:function(a){e.courseName(t.value,s)}}},[a("a",{class:{"sy-theme-text-active":e.curIndex==s},attrs:{href:"javascript:void(0)"}},[e._v(e._s(t.name))])])})):a("span",{staticClass:"tc"},[e._v(e._s(e.emptyText))])])]),e._v(" "),a("div",{staticClass:"sy-upload-page-tree",style:{"margin-left":e.cValue?"0":"190px"}},[e.catalogTreeData&&e.catalogTreeData.length>0?a("sy-ztree",{attrs:{idName:"coursesTree",treeData:e.catalogTreeData,titleChecked:"",defaultChecked:e.defaultChecked,showRadioBox:"",isExpendAll:"",radioType:"all"},on:{"checked-node":e.checkedCourses}}):a("span",[e._v(e._s(e.emptyTextCatalogTree))])],1)]),e._v(" "),a("div",{slot:"footer"},[a("el-button",{attrs:{type:"",size:"small"},on:{click:function(t){e.coursesDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addNewBtn},on:{click:e.submitCourses}},[e._v("确 定")])],1)]),e._v(" "),a("sy-dialog",{attrs:{"append-to-body":"",title:"选择知识点","close-on-click-modal":!1,position:"middle",width:"600px",height:"380px",slide:"fade",visible:e.choseNnowledgelDialog},on:{"update:visible":function(t){e.choseNnowledgelDialog=t}}},[a("div",{staticStyle:{padding:"0 10px"},slot:"body"},[a("div",{staticClass:"sy-row"},[a("div",{staticClass:"sy-col sy-20"},[e.nowledgelTreeData&&e.nowledgelTreeData.length>0?a("sy-ztree",{attrs:{idName:"nowledgelTree",treeData:e.nowledgelTreeData,defaultChecked:e.nowledgelChecked,showRadioBox:"",isExpendAll:"",titleChecked:"",radioType:"all"},on:{"checked-node":e.checkedNode}}):a("span",[e._v(e._s(e.emptyText))])],1)])]),e._v(" "),a("div",{slot:"footer"},[a("el-button",{attrs:{type:"",size:"small"},on:{click:function(t){e.choseNnowledgelDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addNewBtn},on:{click:e.submitNnowledge}},[e._v("确 定")])],1)]),e._v(" "),a("sy-dialog",{attrs:{"append-to-body":"",title:"提示","close-on-click-modal":!1,position:"middle",width:"300px",height:"200px",slide:"fade",visible:e.deleteColumnDialog},on:{"update:visible":function(t){e.deleteColumnDialog=t}}},[a("div",{staticStyle:{padding:"10px"},slot:"body"},[a("div",{staticClass:"el-message-box__content"},[a("span",{staticClass:"el-message-box__status el-icon-warning"}),e._v(" "),a("div",{staticClass:"el-message-box__message",staticStyle:{"margin-left":"50px"}},[a("p",[e._v("确认删除该资源吗？")])])])]),e._v(" "),a("div",{slot:"footer"},[a("el-button",{attrs:{type:"",size:"small"},on:{click:function(t){e.deleteColumnDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addNewBtn},on:{click:e.submitDeleteColumn}},[e._v("确 定")])],1)]),e._v(" "),a("sy-dialog",{attrs:{"append-to-body":"",title:"选择已有标签","close-on-click-modal":!1,position:"middle",width:"600px",height:"380px",slide:"fade",visible:e.choseLabelDialog},on:{"update:visible":function(t){e.choseLabelDialog=t}}},[a("div",{staticStyle:{padding:"10px"},slot:"body"},[a("div",{staticClass:"sy-row"},[a("div",{staticClass:"sy-col sy-20"},[e.labels&&e.labels.length>0?a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.labels,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})):a("span",[e._v(e._s(e.emptyText))])],1)])]),e._v(" "),a("div",{slot:"footer"},[a("el-button",{attrs:{type:"",size:"small"},on:{click:function(t){e.choseLabelDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addNewBtn},on:{click:e.submitLabel}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]}},XRJc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("ukDs"),i=(a.n(s),a("6G3N"));t.default={name:"Upload",mixins:[i.a]}},YE7g:function(e,t,a){"use strict";a.d(t,"c",function(){return i}),a.d(t,"d",function(){return l}),a.d(t,"e",function(){return o}),a.d(t,"b",function(){return r}),a.d(t,"f",function(){return n}),a.d(t,"a",function(){return d}),a.d(t,"g",function(){return h}),a.d(t,"h",function(){return u});var s=a("r6Pd"),i=function(e){return a.i(s.a)("GET","/api/base/rc/course",e)},l=function(e){return a.i(s.a)("GET","/api/base/rc/teacher/teacher_grade_course",e)},o=function(e){return a.i(s.a)("GET","/api/base/lib/catalog/list",e)},r=function(e){return a.i(s.a)("GET","/api/rc/resource_type/"+e)},n=function(e){return a.i(s.a)("GET","/api/base/knowpoint/find/tree",e)},d=function(e){return a.i(s.a)("GET","/api/rc/routineManage",e)},h=function(e){return a.i(s.a)("GET","/api/rc/label",e)},u=function(e){return a.i(s.a)("PUT","/api/rc/resource/upload/basic",e)}},ukDs:function(e,t){}});